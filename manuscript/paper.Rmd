---
title: |
  |  \Large Enforcers are fine, probably.  
author: | 
  | \large Zach Binney \vspace{-1.1mm}
  | \normalsize Epi \vspace{-1mm}
  | \normalsize Oxford something at Emory \vspace{-1mm}
  | \normalsize Georgia? \vspace{-1mm}
  | \normalsize [`email`](mailto:ypu@something.edu) \vspace{-1mm}
  |
  | \large Brian M. Mills \vspace{-1.1mm}
  | \normalsize College of Education \vspace{-1mm}
  | \normalsize University of Texas at Austin \vspace{-1mm}
  | \normalsize Austin, TX 78712 \vspace{-1mm}
  | \normalsize [`brian.mills@austin.utexas.edu`](mailto:brian.mills@austin.utexas.edu) \vspace{-1mm}
  |
  | \large Leigha DeRango \vspace{-1.1mm}
  | \normalsize Department of Mathematics and Statistics \vspace{-1mm}
  | \normalsize Loyola University Chicago \vspace{-1mm}
  | \normalsize Chicago, IL 60660 \vspace{-1mm}
  | \normalsize [`lderango@luc.edu`](mailto:lderango@luc.edu) \vspace{-1mm}
  |
  | \large Gregory J. Matthews \vspace{-1.1mm}
  | \normalsize Department of Mathematics and Statistics \vspace{-1mm}
  | \normalsize Center for Data Science and Consulting \vspace{-1mm}
  | \normalsize Loyola University Chicago \vspace{-1mm}
  | \normalsize Chicago, IL 60660 \vspace{-1mm}
  | \normalsize [`gmatthews1@luc.edu`](mailto:gmatthews1@luc.edu) \vspace{-1mm}
abstract: |
  | \vspace{2mm}
  | *Keywords*: survival analysis, hockey, 
bibliography: references.bib
fontsize: 12pt
link-citations: true
linkcolor: cyan
urlcolor: cyan
output:
  pdf_document:
    df_print: kable
    number_sections: true
    keep_tex: true
header-includes:
 \usepackage{setspace}
 \setstretch{1.15}
 \usepackage{float}
 \floatplacement{figure}{t}
---

```{r setup, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	fig.align = "center",
	message = FALSE,
	warning = FALSE
)

gjm <- function(x, color = "red") {
  sprintf("\\textcolor{%s}{%s}", color, x)}
```

```{r pkgs}
library(tidyverse)
library(dplyr)
library(stringr)
theme_set(theme_minimal())
```


```{r echo = FALSE}
#Reading in the raw data from the paper.  
library(tidyverse)
gen_JAMA <- read.csv("/Users/gregorymatthews/Dropbox/HockeyEnforcersGit/JAMA NHL Data/General-Table 1.csv")
death_JAMA <- read.csv("/Users/gregorymatthews/Dropbox/HockeyEnforcersGit/JAMA NHL Data/Deaths-Table 1.csv")

dead <- read.csv("/Users/gregorymatthews/Dropbox/HockeyEnforcersGit/deaths.csv")
#Filtering for players who started in or after 1967.  
dead <- dead %>% filter(From >= 1967 & Name != "Name")




# Pelle Lindbergh -> that was his real name, no other spelling, not sure about this one
dead$Name[dead$Name == 'Lars-Erik SjÃ¶berg'] <- 'Lars Sjoberg'
dead$Name[dead$Name == 'BjÃ¸rn Skaare'] <- 'Bjorn Skaare'
dead$Name[dead$Name == 'Roger HÃ¤gglund'] <- 'Roger Hagglund'
dead$Name[dead$Name == 'Michel Larocque'] <- 'Mario Larocque' # matched by birth year
#	Fern Rivard -> Bob Rivard is in JAMA but the birthdays don't match, this is Fernand Joseph Rivard who is not in JAMA
dead$Name[dead$Name == 'Yanick DuprÃ©'] <- 'Yanick Dupre'
dead$Name[dead$Name == 'DuÅ¡an PaÅ¡ek'] <- 'Dusan Pasek'
# Roy Edwards -> this is Allan Roy Edwards (matched w/ google by birthday), not in JAMA
dead$Name[dead$Name == 'StÃ©phane Morin'] <- 'Stephane Morin'
dead$Name[dead$Name == 'Dmitri Tertyshny'] <- 'Dimitri Tertyshny'
# Garry Bauman -> Garry Glenwood Bauman, matched on google by birthday, not in JAMA under gary, Garry, Bauman, or Glenwood
dead$Name[dead$Name == 'GaÃ©tan Duchesne'] <- 'Gaetan Duchesne'
# Michel Plasse -> Michel Pierre Plasse, matched by birthday, not in JAMA under Michel, Pierre, or Plasse
# Chris Worthy -> Christopher John Worthy, matched by birthday, not in JAMA under last name Worthy or 'Christopher John'
dead$Name[dead$Name == 'Miroslav DvoÅ™Ã¡k'] <- 'Miroslav Dvorak'
# Wayne Stephenson -> Wayne Frederick Stephenson, matched by birthday, not in JAMA under Wayne or Frederick
dead$Name[dead$Name == 'Igor Vyazmikin'] <- 'Igor Viazmikin'
dead$Name[dead$Name == 'Rick Martin'] <- 'Richard Martin'
dead$Name[dead$Name == 'Karel RachÅ¯nek'] <- 'Karel Rachunek'
dead$Name[dead$Name == 'KÄrlis SkrastiÅ†Å¡'] <- 'Karlis Skrastins'
dead$Name[dead$Name == 'Josef VaÅ¡Ã­Äek'] <- 'Josef Vasicek'
dead$Name[dead$Name == 'Kaspars AstaÅ¡enko'] <- 'Kaspars Astashenko'
dead$Name[dead$Name == 'Jeff McDill'] <- 'Jeffrey McDill'
# Joe Junkin -> Joseph Brian Junkin, matched by birthday, last name not present in JAMA
# Andre Gill -> there is another player born in 84 with the same name but neither are in JAMA
# Seth Martin -> matched by birthday, didn't go by another name, not in JAMA
#	Don McLeod -> Donald Martin McLeod, matched by birthday, not in JAMA 
dead$Name[dead$Name == 'Greg Parks'] <- 'Gregory Parks'
# Ken Broderick -> Kenneth Lorne Broderick, matched by birthday, last name not in JAMA
# Don Caley -> Donald Thomas Caley, matched by birthday, last name not in JAMA
# Ed Dyck -> Edwin Paul 'Ed' Dyck, matched by birthday, NOT Henry Dyck who is only Dyck in JAMA
#	Sergei Mylnikov -> Sergei Aleksandrovich Mylnikov, matched by birthday, not in JAMA
dead$Name[dead$Name == 'Marek SvatoÅ¡'] <- 'Marek Svatos'
#Ray Emery -> Raymond Robert Emery, matched by birthday, last name not in JAMA
dead$Name[dead$Name == 'Bob Sullivan'] <- 'Robert Sullivan'
dead$Name[dead$Name == 'Denis DupÃ©rÃ©'] <- 'Denis Dupere'
#	Jim McLeod -> Jimmy McLeod, birthday doesn't match any McLeods in JAMA
dead$Name[dead$Name == 'Dmitri Nabokov'] <- 'Dimitri Nabokov'
# Jim Pettie -> James 'Seaweed' Pettie, matched by birthday, last name not in JAMA
#	Tony Esposito -> Anthony James "Tony O" Esposito, matched by birthday, not in JAMA
dead$Name[dead$Name == 'Miroslav FryÄer'] <- 'Miroslav Frycer'
# Gary Inness -> Gary George Inness, matched by birthday, last name not in JAMA
# Matiss Kivlenieks -> Matiss Kivlenieks, matched by birthday, not in JAMA
dead$Name[dead$Name == 'RenÃ© Robert'] <- 'Rene Robert'
# Ken Brown -> Kenneth Murray Brown, matched by birthday, not in JAMA
# Robbie Moore -> Robert David Moore, matched by birthday, not in JAMA
# Curt Ridley -> Charles Curtis Ridley, matched by birthday which is actually off by one day but def not Mike Ridley in JAMA
dead$Name[dead$Name == 'Greg Tebbutt'] <- 'Gregory Tebbutt'
#Mike Blake -> Michael Wilmer Blake, matched by birthday, not in JAMA
dead$Name[dead$Name == 'Petr KlÃ­ma'] <- 'Petr Klima'
dead$Name[dead$Name == 'BÃ¶rje Salming'] <- 'Borje Salming'


gen_JAMA$GP <- as.numeric(gsub(",","",gen_JAMA$GP))
gen_JAMA$PIM <- as.numeric(gsub(",","",gen_JAMA$PIM))
dead$GP <- as.numeric(dead$GP)
dead$From <- as.numeric(dead$From)
dead$G <- as.numeric(dead$G)
gen_JAMA %>% filter(X1st.Season.Corrected >= 1967) %>% nrow()
dat <- gen_JAMA %>% filter(X1st.Season.Corrected >= 1967) %>% left_join(select(dead,Name,Birth.Date,Death.Date,GP),by = c("Player" = "Name" ))

#Remove goalies 
#There is no one to remove because there are no goalies in the original data set.  
dat <- dat %>% filter(Pos != "G")



#Dataprep
dat <- dat %>% mutate(dead = !is.na(Death.Date), 
                      DOB = as.Date(DOB), 
                      Death.Date = as.Date(Death.Date))
#I'm using the date of the latest death date as the censoring time: May 7, 2023
dat$Death.Date[!dat$dead] <- as.Date("2023-05-07")
dat$age <- (dat$Death.Date - dat$DOB)/365
dat$Ht <- as.numeric(dat$Ht)
dat$Wt <- as.numeric(dat$Wt)
dat$FperG <- dat$Total.Fights/dat$GP.x
dat$Pos <- as.factor(dat$Pos)
dat$Ctry2 <- dat$Ctry
dat$Ctry2[!dat$Ctry2 %in% c("FIN","CZE","RUS","SWE","USA","CAN")] <- "OTH" 
dat$Ctry2 <- as.factor(as.character(dat$Ctry2))
#At least 50, not greater than 50.
dat$EF <- dat$Total.Fights>=50


#Cleaning penalty minutes
pm_temp <- data.frame(do.call(rbind,strsplit(dat$PIM.GP,":")))
dat$PIM.GP_numeric <- as.numeric(pm_temp[,1]) + as.numeric(pm_temp[,2])/60
dat$EP <- dat$PIM.GP_numeric >=3
#I match the paper's n = 183 EP.But when I remove the people with missing height, I lose one of the 182 and end up with 182.

#Removed 4 rows
dat <- dat %>% filter(!is.na(Ht))

summ <-
  dat %>% group_by(EF) %>% summarize(
    n = n(),
    mnage = round(mean(age), 2),
    seage = round(sd(age) / sqrt(n),3),
    mnwt = round(mean(Wt), 2),
    sewt = round(sd(Wt) / sqrt(n),3),
    mnht = round(mean(Ht), 2),
    seht = round(sd(Ht) / sqrt(n),3),
    mngoals = round(mean(G), 2),
    segoals = round(sd(G) / sqrt(n),3),
    mntf = round(mean(Total.Fights), 2),
    setf = round(sd(Total.Fights) / sqrt(n),3),
    mnpimgp = round(mean(PIM.GP_numeric), 2),
    sepimgp = round(sd(PIM.GP_numeric) / sqrt(n),3)
    
  )

summEP <-
  dat %>% group_by(EP) %>% summarize(
    n = n(),
    mnage = round(mean(age), 2),
    seage = round(sd(age) / sqrt(n),3),
    mnwt = round(mean(Wt), 2),
    sewt = round(sd(Wt) / sqrt(n),3),
    mnht = round(mean(Ht), 2),
    seht = round(sd(Ht) / sqrt(n),3),
    mngoals = round(mean(G), 2),
    segoals = round(sd(G) / sqrt(n),3),
    mntf = round(mean(Total.Fights), 2),
    setf = round(sd(Total.Fights) / sqrt(n),3),
    mnpimgp = round(mean(PIM.GP_numeric), 2),
    sepimgp = round(sd(PIM.GP_numeric) / sqrt(n),3)
  )


```   

\newpage

# Introduction {#sec:intro}

Fighting in the National Hockey League (NHL) has been an integral part of the sport since the earliest days of the league. More than just a way to express frustration, players often use fighting strategically to the benefit of the team. One of these strategies includes instigating a fight when a player from the opposite team has violated an unwritten rule of the game. This has led to the rise of teams carrying so called "enforcers" on their rosters. An enforcer is a player who, along with being a regular player, is the one tasked with fighting these opposing players. This is not an officially defined position, of course, but the nature of needing to be able to fight any opponent generally designates the players most likely to be enforcers (large, dense, intimidating players). 

@Colburn1986 discusses the intentionality behind these public fights. The crowd gets energized and entertained, but more importantly, the fight is a stage used to establish the social customs and expectations of players on the ice. He says,  "insofar as the fist-fight is the locus of socially available beliefs concerning the moral character and integrity of players, ... the fist-fight represents a mode of informal social control among players" (Colburn 70). 

A researcher who looked anecdotally at how enforcers fit into a team atmosphere noticed that teammates put their enforcers on a pedestal. Performing well as an enforcer leads to the player being seen as a protector. When an enforcer fulfills these additional responsibilities to being on the ice as a normal player, players say that it is common for that enforcer to recieve perks, such as not paying for their own meals or getting the best seat on the bus. She goes as far as to say these players are "deified", emphasizing the social aspects of hockey that surround this history of violence. (Silverwood 2015).  

While any player on a hockey team can get into a fight, enforcers are exposed to many more fights than your everyday average NHL player. As a result of being exposed to these fights, they are experience additional head trauma, above and beyond the normal head trauma associated with hockey. There are many questions about the long-term implications of this head trauma and if it may have any health effects on these types of players. The ingrained nature of fighting into the game of hockey is greatly criticized and there are many active debates about its current declining trend. Should the game continue to move away from fighting in favor of younger, faster, highly-skilled players? Undebatably, however, fighting has historically been a non-negligible part of the game and correctly understanding the implications this has on player health may help direct the future of the sport. 

A paper written by @Popkin2023, et al. and published in the Journal of the American Medical Association  explored the effects of being an enforcer on mortality rates and causes of death. They defined enforcers in two groups: those who had 50 or more career fights (E-F cohort), and those who had, on average, more than 3 penalty minutes per game (E-P cohort). Then, each of these players was matched to a non-enforcer counterpart based on date of birth, total games played, height, weight, and position played (C-F and C-P cohorts, respectively). These matched controls were then tested to confirm that there were not any significant differences between the variables matched on between the controls and group. 

Their analysis continues by considering the E-F cohort and their matched controls separately from the E-P cohort. Conditioning on death, they then estimated, separately, that the enforcer groups from each cohort (E-F = 13, E-P = 13) died on average 10 years before their non-enforcer counterparts(C-F = 14, C-P = 10). Then, considering all enforcers from both cohorts together, and all controls from both cohorts together, and then conditioning on death (resulting in 21 enforcers and 24 controls), they draw the conclusion that there is not a significant difference in all-cause mortality rate but that enforcers died more frequently of drug overdose and suicide. 

If true, this is truly an alarming finding.  However, upon examining their statistical methods and attempting to reproduce their results using a survival analysis approach, which we believe is more appropriate, we were unable to reach the same conclusions as @Popkin2023.  

Inspired by the applicability of survival analysis to this study, and concerned about the gravity of @Popkin2023's conclusions in light of the statistical methods originally used, we instead found more data using web-scraping methods and the NHL website to facilitate a reanalysis of the effects of being an enforcer in terms of survival time rather than mortality rate. This shift in perspective allows us to overcome the downfall of mortality rate, which is that it is a function of when it is calculated. Eventually, the mortality rate will always be 100% when all members of the original sample have died. Instead, survival analysis provides a survival curve, which can be used to analyze how the probability of survival changes over time. 

As mentioned earlier, the outcome of this study is relevant to the debates about regulations and discourse around head trauma in hockey. An accurate analysis is imperative to prevent the spread of misinformed conclusions. ... talk about our conclusions


Interesting paper: Don't do PS matching: https://gking.harvard.edu/publications/why-propensity-scores-should-not-be-used-formatching

silverwood: https://orca.cardiff.ac.uk/id/eprint/86257/12/Victoria%20Silverwood%20Final%20Thesis%20SIGS%20REMOVED.pdf

colburn: https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1533-8525.1986.tb00249.x

# Data 
We obtained the two data sets used in @Popkin2023: general table (n = 7432) and death table (n = 45).  After filtering for players who's first season was 1967 or greater, there are 6039 observations remaining (the exact number mentioned in @Popkin2023).  

@Popkin2023 presents a matched cohort study with n = 6039 NHL players who played any games between the 1967-68 and the 2021-22 NHL seasons.  (We removed 4 players with missing values for height leaving us with 6035 observations for analysis.)  They then define a player as an enforcer in one of two ways: 

1. EF: Any player with at least 50 career fights (n = 331)
2. EP: Any player who averaged at least 3 penalty minutes per game (n = 183)

The same definitions of enforceres presented in @Popkin2023 are used this current manuscript for comparison purposes.  

<!-- (Note: In our analysis I only have 182 players who are defined as EP) -->

While @Popkin2023 only looks at a total of 45 deceased players  (21 enforcers and 24 controls), we scraped hockey-reference.com and identified `r sum(dat$dead)` players who were included in the data used in @Popkin2023 who were deceased as of May 7, 2023.  The analysis presented here will utilize all hockey players in the data used in @Popkin2023, both alive and deceased, in a survival analysis to explore differences in survival times between enforcers an non-enforcers.  

# Descriptive statistics

After removing 4 players who were missing heights, there were `r nrow(dat)` players included in our analysis.  Of these players, on average, enforcers in this data set tended to be older than the non-enforcers (EF: `r summ$mnage[summ$EF]` vs non-EF: `r summ$mnage[!summ$EF]` and EP: `r summEP$mnage[summEP$EP]` vs non-EP: `r summEP$mnage[!summEP$EP]`).  Additionally, as seen in Tables \ref{EDAEF} and \ref{EDAEP} enforcers tended to also be taller and heavier on average than non-enforcers
	

<!-- add a table here with summary statistics comparing the groups EF and EP.-->


\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
 Variable & EF = TRUE & EF = FALSE & p-value \\
 \hline
 Age (years) & `r summ$mnage[summ$EF]` (`r summ$seage[summ$EF]`) & `r summ$mnage[!summ$EF]` (`r summ$seage[!summ$EF]`) & `r ifelse(round(t.test(dat$age~dat$EF)$p.value,2) <0.0001,"<0.0001",round(t.test(dat$age~dat$EF)$p.value,2))`\\
 Weight (lbs) & `r summ$mnwt[summ$EF]` (`r summ$sewt[summ$EF]`) & `r summ$mnwt[!summ$EF]` (`r summ$sewt[!summ$EF]`) & `r ifelse(round(t.test(dat$Wt~dat$EF)$p.value,2) <0.0001,"<0.0001",round(t.test(dat$age~dat$EF)$p.value,2))`\\
  Height (in) & `r summ$mnht[summ$EF]` (`r summ$seht[summ$EF]`) & `r summ$mnht[!summ$EF]` (`r summ$seht[!summ$EF]`) & `r ifelse(round(t.test(dat$Ht~dat$EF)$p.value,2) <0.0001,"<0.0001",round(t.test(dat$Ht~dat$EF)$p.value,2))`\\
    Goals  & `r summ$mngoals[summ$EF]` (`r summ$segoals[summ$EF]`) & `r summ$mngoals[!summ$EF]` (`r summ$segoals[!summ$EF]`) & `r ifelse(round(t.test(dat$G~dat$EF)$p.value,2) <0.0001,"<0.0001",round(t.test(dat$G~dat$EF)$p.value,2))`\\
 \hline
\end{tabular}
\end{center}
\label{EDAEF}
\caption{test}
\end{table}


\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
 Variable & EP = TRUE & EP = FALSE & p-value \\
 \hline
 Age (years) & `r summEP$mnage[summEP$EP]` (`r summEP$seage[summEP$EP]`) & `r summEP$mnage[!summEP$EP]` (`r summEP$seage[!summEP$EP]`) & `r ifelse(round(t.test(dat$age~dat$EP)$p.value,2) <0.0001,"<0.0001",round(t.test(dat$age~dat$EP)$p.value,2))`\\
 Weight (lbs) & `r summEP$mnwt[summEP$EP]` (`r summEP$sewt[summEP$EP]`) & `r summEP$mnwt[!summEP$EP]` (`r summEP$sewt[!summEP$EP]`) & `r ifelse(round(t.test(dat$Wt~dat$EP)$p.value,2) <0.0001,"<0.0001",round(t.test(dat$age~dat$EP)$p.value,2))`\\
  Height (in) & `r summEP$mnht[summEP$EP]` (`r summEP$seht[summEP$EP]`) & `r summEP$mnht[!summEP$EP]` (`r summEP$seht[!summEP$EP]`) & `r ifelse(round(t.test(dat$Ht~dat$EP)$p.value,2) <0.0001,"<0.0001",round(t.test(dat$Ht~dat$EP)$p.value,2))`\\
 \hline
\end{tabular}
\end{center}
\label{EDAEP}
\caption{Here is the caption for this table}
\end{table}

```{r echo = FALSE}
library(survival)
#Defining the survival variable
dat$Surv <- Surv(dat$age,dat$dead)
dat$EFchar <- "Enforcer"
dat$EFchar[!dat$EF] <- "Non-enforcer"
dat$EFchar <- as.factor(dat$EFchar)
dat$EPchar <- "Enforcer"
dat$EPchar[!dat$EP] <- "Non-enforcer"
dat$EPchar <- as.factor(dat$EPchar)

#Group forwards together
dat$Pos2 <- as.character(dat$Pos)
dat$Pos2[dat$Pos2 %in% c("L","R")] <- "W"
dat$Pos2 <- factor(dat$Pos2)
```

```{r fig:KMEF, echo = FALSE, fig.cap="Kaplan Meier plot for EF" }
library(ggsurvfit)
survfit2(Surv ~ EFchar, data = dat) %>%
  ggsurvfit() +
  labs(
    x = "Age",
    y = "Overall survival probability"
  ) +
  add_confidence_interval()
```

```{r fig:KMEp, echo = FALSE, fig.cap="Kaplan Meier plot for EP" }
library(ggsurvfit)
survfit2(Surv ~ EPchar, data = dat) %>% 
  ggsurvfit() +
  labs(
    x = "Age",
    y = "Overall survival probability"
  ) + 
  add_confidence_interval()
```

Figures \@ref(KMEF) and \@ref(KMEP) show Kaplan-Meier plots for EF and EP

# Methods {#sec:methods}
In the matched cohort study presented in @Popkin2023, enforcers were matched to non-enforcers on birth year, weight, height, etc.  After matching, mortality rates between the two groups were computed.  Neither definition of enforcers (i.e. E-F or E-P) yielded significant difference in the mortality rates between enforcers and non-enforcers.  

<!-- (Greg comment: After matching you CAN compare mortality rates and that comparison would be valid AT THAT GIVEN POINT when they are compared.  But a better analysis would be to use survival analysis.  The problem with mortality rate is that eventually everyone in both groups will be dead if you wait long enough and that comparison is meaningless. Survival times are much better comparison. ) -->

However, the authors of @Popkin2023 next conditioned on death yielding a sample size of n = 13 and n = 14 for the enforcer (defined by total fights) vs non-enforcer group, respectively, and show that the age at death is about 10 years less for the enforcers group relative to the non-enforcer group (p = 0.03).  This approach is not statistically valid, since once death is conditioned upon, the matching that is used to balance the two groups is broken and they can become imbalanced, which is what we believe the authors in @Popkin2023 observed.  

This current manuscript aims to perform a re-analysis of the original study using survival analysis techniques, specifically Cox proportional hazards models, to look for differences in survival times of enforcers versus non-enforcers.  

<!-- Greg doesn't think this conditioning on death is valid!  The point of matching is to balance the groups in regards to confounders.  However, after matching, you can't just look at a subset and compare between then two groups because you could end up with unbalanced sets!  And indeed we do see this!  For example, the weight in the dead enforcers group is on average higher than the weight of the dead non-enforcers group.   -->




# Results {#sec:results}
Two Cox proportional hazards models [CITATION] were fit: one for each definition of enforcer defined in @Popkin2023 (i.e. E-F and E-P).  In addition, to indicators for each definition of enforcer, games played (GP), height (Ht), weight (Wt), year of birth (DOB), and position (Center (C), Wing (W), or Defender(D)) were added to each model as control variables.  

Table \ref{tab:EF} shows the results for the Cox model when enforcers were defined based on their number of career fights.  No statistically significant difference was observed in the hazard functions of enforcers versus non enforcers (p-value = 0.54856).  

However, a significant difference is observed in between enforcers and non-enforcers when the enforcers is defined based on their number of penalty minutes per game (p-value = 0.00169).  The estimated effect for E-P is 0.83023.  When exponentiated, this value is 2.29385, indicating approximately a 129\% increase in the hazard for enforcers vs non-enforcers when all other variables are held constant.  Fixing the levels of the continuous predictors at their mean values and fixing position to be defender, the estimated survival rate at the age of 50 for enforcers is 96.57\% (95\% CI: 94.63\%, 98.56\%) vs 98.49\% (95\% CI: 97.98\%, 99.00\%).  For the same conditions at the age of 75, the estimated survival rate for enforcers is about 74.4\% (95\% CI: 61.4\%, 90.32\%) compared to non-enforcers estimate survival rate of 87.95\% (95\% CI: 83.09\%, 93.10\%).  

<!-- ind surv lower upper time -->
<!-- Non-Enforcer 0.9849056 0.9798140 0.9900238 50.00000 -->
<!--  Enforcer 0.9657134 0.9462748 0.9855513 50.00000 -->
 
 <!-- Non-Enforcer 0.8795039 0.8308666 0.9309884 75.01096 -->
 <!-- Enforcer 0.7448857 0.6142941 0.9032394 75.01096 -->


<!-- % latex table generated in R 4.2.2 by xtable 1.8-4 package -->
<!-- % Mon Feb 26 09:06:03 2024 -->
\begin{table}[ht]
\centering
\begin{tabular}{rrrrr}
  \hline
 & $\beta$ & $e^{\beta}$ & s.e. & p-value \\ 
  \hline
E-F TRUE & 0.17328 & 1.18920 & 0.28884 & 0.54856 \\ 
  GP & -0.00059 & 0.99941 & 0.00022 & 0.00815 \\ 
  Ht & -0.04484 & 0.95615 & 0.04430 & 0.31144 \\ 
  Wt & 0.02274 & 1.02300 & 0.00652 & 0.00049 \\ 
  DOB & -0.01766 & 0.98250 & 0.00821 & 0.03140 \\ 
  $I_D$ & -0.36479 & 0.69434 & 0.17428 & 0.03633 \\ 
  $I_W$ & -0.25905 & 0.77178 & 0.15869 & 0.10258 \\ 
   \hline
\end{tabular}
\caption{E-F}
\label{tab:EF}
\end{table}




<!-- % latex table generated in R 4.2.2 by xtable 1.8-4 package -->
<!-- % Mon Feb 26 09:04:35 2024 -->
\begin{table}[ht]
\centering
\begin{tabular}{rrrrr}
  \hline
 & $\beta$ & $e^{\beta}$ & s.e. & p-value \\ 
  \hline
E-P TRUE & 0.83023 & 2.29385 & 0.26443 & 0.00169 \\ 
  GP & -0.00051 & 0.99949 & 0.00021 & 0.01759 \\ 
  Ht & -0.03859 & 0.96215 & 0.04406 & 0.38111 \\ 
  Wt & 0.02001 & 1.02022 & 0.00654 & 0.00221 \\ 
  DOB & -0.01778 & 0.98238 & 0.00827 & 0.03150 \\ 
  $I_D$ & -0.36900 & 0.69142 & 0.17444 & 0.03440 \\ 
  $I_W$ & -0.28804 & 0.74973 & 0.15946 & 0.07087 \\ 
   \hline
   \hline
\end{tabular}
\caption{E-P}
\label{tab:EP}
\end{table}

Figure \@ref(fig:estsurv)

```{r fig:estsurv, echo = FALSE, fig.cap = "Estimated Survival curve for EP for defenders.  All other variables are fixed at their mean level (GP = 285.8, Ht = 72.7in, Wt = 197.03, and Year of birth 1974.5."}
coxphmod_EP <- coxph(Surv ~ EP + GP.x + Ht + Wt + DOB.Year + Pos2, data = dat)
# summary(coxphmod_EP)
# library(xtable)
# xtable(summary(coxphmod_EP)$coef[,-4],digits = 5)
# cox.zph(coxphmod_EP)


newdataEP <-
  with(dat, data.frame(EP = c(TRUE, FALSE), 
                       GP.x = rep(mean(GP.x), 2),
                       Ht = rep(mean(Ht), 2),
                       Wt = rep(mean(Wt), 2),
                       DOB.Year = rep(mean(DOB.Year), 2),
                       Pos2 = rep("D", 2))
                       )
#plot(survfit(coxphmod_EP, newdata = newdataEP), conf.int = TRUE, lty = c(1,2))


nnn <- nrow(survfit(coxphmod_EP, newdata = newdataEP)$surv)
ggdat <- data.frame(enforcer = c(rep("Enforcer",nnn),rep("Non-Enforcer",nnn)),
  surv = c(
  survfit(coxphmod_EP, newdata = newdataEP)$surv[, 1],
  survfit(coxphmod_EP, newdata = newdataEP)$surv[, 2]
),
  lower = c(
  survfit(coxphmod_EP, newdata = newdataEP)$lower[, 1],
  survfit(coxphmod_EP, newdata = newdataEP)$lower[, 2]
),
  upper = c(
  survfit(coxphmod_EP, newdata = newdataEP)$upper[, 1],
  survfit(coxphmod_EP, newdata = newdataEP)$upper[, 2]
),
time = rep(survfit(coxphmod_EP, newdata = newdataEP)$time,2)
)
ggplot(aes(x = time,y = surv, color = enforcer), data = ggdat) + geom_path() + geom_path(aes(x = time,y = lower, color = enforcer), lty = 3) + geom_path(aes(x = time,y = upper, color = enforcer), lty = 3) 


```

Talk about the conditioning on death stuff.  

Age difference statement in Popkin is over stated.  

# Conclusion {#sec:conclusion}

# Acknowledgements {-}

# Supplementary Material {-}

All code for reproducing the analyses in this paper is publicly available at https://github.com/gjm112/HockeyEnforcers

# References
